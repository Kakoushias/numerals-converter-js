FROM node:18-alpine

WORKDIR /app

# Install dependencies for testing
RUN apk add --no-cache bash curl

# Copy workspace configuration
COPY package*.json ./

# Copy package.json files for all workspaces
COPY backend/package*.json ./backend/
COPY frontend/package*.json ./frontend/

# Install all workspace dependencies
RUN npm ci

# Copy source code for both packages
COPY backend/ ./backend/
COPY frontend/ ./frontend/

# Default command runs all tests
CMD ["npm", "test"]

